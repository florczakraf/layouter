<html>

<head>
    <meta charset="UTF-8">
    <style>
        body {
            background-color: powderblue;
            color: black;
            overflow: hidden;
            margin: 0px;
            padding: 0px;
        }

        .invisible {
            display: none;
        }

        #canvas {
            width: 2560px;
            height: 1440px;
        }
    </style>
    <script>
        const W = 2560;
        const H = 1440;
        const MAX_SIZE = 250;
        const MIN_SIZE = 200;
        Array.prototype.sample = function () { return this[Math.floor(Math.random() * this.length)] }
        let IMGS = new Array();
        let IMGS2 = new Array();
        // echo -n '["'; ls -q1 | paste -sd, - | sed 's/,/\", \"/g' | tr -d '\n'; echo '"]'
        IMG_NAMES = ["adam małysz.png", "agatka.jpg", "alan-rickman.jpg", "alan-rickman-2.jpg", "alice cooper.png", "andrzej gołota.png", "andrzej grabarczyk.png", "andrzej grabowski.png", "andrzej nejman.png", "andrzej piaseczny.png", "angus macgyver.png", "anna jurksztowicz.png", "anna maria wesołowska.png", "artur.jpg", "avgn.png", "avgn-2.png", "bb-king.jpg", "beata-kozidrak.jpg", "bob ross.png", "bogusław linda.png", "boguslaw-linda.jpg", "bolesław prus.png", "borat.jpg", "borys szyc.png", "bożena dykiel.png", "brad-pitt.jpg", "bronisław cieślak.png", "bruce-campbell.jpg", "bruce-lee.jpg", "bruce-willis.jpg", "captain disillusion.png", "chada.png", "chajzer.jpg", "chopin.jpg", "christoph-waltz.jpg", "ciemny żmij au.png", "cubanpete.png", "cyndi lauper.png", "czesław niemen.png", "czeslaw-majewski.jpg", "danny-trejo.jpg", "david-hasselhoff.jpg", "dexterw.jpg", "dicaprio.jpg", "doda.png", "doge.png", "doktornauk.png", "dolce.png", "dumbledorez.png", "dwayne the rock johnson.png", "ed sheeran.png", "eddie murphy.png", "elon musk.png", "elvis presley.png", "enrico-palazzo.jpg", "erdo.png", "fatboy slim.png", "freddie mercury.png", "fronczewski.jpg", "gajus-ceplus.webp", "grzegorz-markowski.jpg", "harrison-ford.jpg", "henryk machalica.png", "hogan.jpg", "hugh-laurie.jpg", "ibisz.jpg", "jacek-kaczmarski.jpg", "jacek-stachursky.jpg", "james rolfe.png", "jan frycz.png", "janczak.jpg", "jan-machulski.jpg", "janusz rewiński.png", "janusz-tracz.jpg", "janusz-tylman.jpg", "jarosław jakimowicz.png", "jarosław kret.png", "jaroslaw-boberek.jpg", "jatowidzialem.png", "jean-claude-van-damme.jpg", "jerzy bończak.png", "jerzy-stuhr.jpg", "jimmy fallon.png", "joe-pesci.jpg", "johhny-sins.jpg", "john cena.png", "john-travolta.jpg", "julian tuwim.png", "karol-krawczyk.jpg", "karol-strasburger.jpg", "katarzyna figura.png", "kayah.jpg", "kazik.png", "keanu-reeves.jpg", "kiryu kazuma.png", "klocuch.png", "kombii-skawinski.jpg", "kopernik.jpg", "kora.jpg", "kraina-grzybow.jpg", "krystyna janda.png", "krystyna-czubowna.jpg", "krzysztof kiersznowski.png", "krzysztof-cugowski.jpg", "krzysztof-krawczyk.jpg", "kuba klawiter.png", "kula.jpg", "lady gaga.png", "laura branigan.png", "leon niemczyk.png", "lordi.jpg", "louis-de-funes.jpg", "lrp.png", "lucy liu.png", "maciej-gudowski.jpg", "madonna.png", "mads-mikkelsen.jpg", "majka-jezowska.jpg", "maklowicz.jpg", "mandaryna.png", "marek grechuta.png", "marek kondrat.png", "marek sierocki.png", "marek-perepeczko.jpg", "maria konopnicka.png", "mariusz pudzianowski.png", "mariya takeuchi.png", "marnypopis.png", "maryla-rodowicz.jpg", "mary-za-ciemno.jpg", "michael jackson nowy.png", "michael jackson stary.png", "michael stevens (vsauce).png", "michał białek.png", "michał milowicz.png", "michał wiśniewski.png", "michal-milowicz.jpg", "mieczysław fogg.png", "mike myers.png", "mirosław baka.png", "mirosław zbrojewicz.png", "morgan-freeman.jpg", "nick-boulder.jpg", "nina-simone.jpg", "norbi.png", "norek.png", "ojciec-mateusz.jpg", "olaf lubaszenko.png", "olonb.png", "owsiak.jpg", "ozzy-osbourne.jpg", "panmieciu.jpg", "paweł wawrzecki.png", "piotr adamczyk.png", "pkr.png", "ps1hagrid.jpg", "radek-kotarski.jpg", "rafał brzozowski.png", "rick-astely-2.jpg", "rick-astley.jpg", "rick-james.jpg", "rick-moranis.jpg", "robert janowski.png", "robert lewandowski.png", "robert więckiewicz.png", "robert-de-niro.jpg", "rowan-atkinson.jpg", "rudi-schuberth.jpg", "rysiek riedel.png", "ryszard-rynkowski.jpg", "schwarzenegger.jpg", "sebastian wątroba.png", "seweryn krajewski.png", "shatner.jpg", "shatner2.jpg", "sidney-polak.jpg", "skryba.png", "sławomir orzechowski.png", "so-cool.png", "stanisław tym.png", "steve-buscemi.jpg", "steven-van-zandt.jpg", "sting.png", "sylvester-stallone.jpg", "szymon wydra.png", "tadeusz sznuk.png", "tak-srednio-bym-powiedzial.jpg", "testo.png", "testo2.png", "tim-roth.jpg", "tomasz karolak.png", "tomasz niecik.png", "tomasz-knapik.jpg", "tom-hanks.jpg", "tommy-lee-jones.jpg", "tommy-vercetti.jpg", "tom-scott.jpg", "tumulec.jpg", "tu-sie-jebnij.jpg", "wally.png", "weird al yankovic.png", "werner3.png", "wide-peepo-gladiator.png", "wislawa-szymborska.jpg", "wladyslaw-bartoszewski.jpg", "wojciech-kilar.jpg", "wojciech-mann.jpg", "wsciekly-waz.jpg", "xardas.jpg", "zaborski.jpg", "zamachowski.jpg", "zbigniew buczkowski.png", "zbigniew-religa.jpg", "zbigniew-wodecki.jpg", "zbigniew-wodecki-2.jpg"]
        IMG_NAMES.forEach(img => {
            let img_elem = new Image();
            img_elem.onload = () => {
                IMGS.push(img_elem);
            }
            img_elem.src = `layout_imgs/${img}`;
        })

        function sleep (time) {
            return new Promise((resolve) => setTimeout(resolve, time));
        }

        function just_draw(canvas, img, x, y) {
            canvas.drawImage(img, x, y);
        }

        function draw_left_to_right(canvas, img, x, y) {
            for (let i = 1; i <= img.width; i++) {
                sleep(i).then(() => {
                    canvas.drawImage(img, 0, 0, i, img.height, x, y, i, img.height);
                });
            }
        }

        function draw_top_to_bottom(canvas, img, x, y) {
            for (let i = 1; i <= img.height; i++) {
                sleep(i).then(() => {
                    canvas.drawImage(img, 0, 0, img.width, i, x, y, img.width, i);
                });
            }
        }

        let draw_functions = [
            just_draw,
            draw_left_to_right,
            draw_top_to_bottom,
        ];

    </script>
</head>

<body>
    <canvas id="canvas" width="2560" height="1440"></canvas>
    <script>
        canvas = document.getElementById("canvas").getContext("2d");
        document.addEventListener("DOMContentLoaded", function () {
            setInterval(() => {
                let img = IMGS.sample();
                if (!img) {
                    if (IMGS2.length != IMG_NAMES.length) {
                        alert("dupa")
                    }
                    IMGS = IMGS2;
                    IMGS2 = new Array();
                    img = IMGS.sample();
                }
                IMGS.splice(IMGS.indexOf(img), 1);
                IMGS2.push(img);

                let x = Math.floor(Math.random() * W);
                let y = Math.floor(Math.random() * H);

                if (img.width <= MAX_SIZE && img.height <= MAX_SIZE) {
                    if (x + img.width > W) {
                        x = W - img.width;
                    }

                    if (y + img.height > H) {
                        y = H - img.height;
                    }

                    draw_functions.sample()(canvas, img, x, y);
                    return;
                }

                let ratio = img.width / img.height;
                let new_width, new_height;
                const bigger_size = MIN_SIZE + Math.floor(Math.random() * (MAX_SIZE - MIN_SIZE));

                if (img.width >= img.height) {
                    new_width = bigger_size;
                    new_height = Math.floor(new_width / ratio);
                }
                else {
                    new_height = bigger_size;
                    new_width = Math.floor(new_height * ratio);
                }

                createImageBitmap(
                    img,
                    { resizeWidth: new_width, resizeHeight: new_height, resizeQuality: 'high' }
                )
                    .then(new_img => {
                        if (x + new_width > W) {
                            x = W - new_width;
                        }

                        if (y + new_height > H) {
                            y = H - new_height;
                        }

                        draw_functions.sample()(canvas, new_img, x, y);

                    }
                    );


            }, 1000);

        }, false);
    </script>
</body>

</html>
